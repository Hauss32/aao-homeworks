{"version":3,"file":"bundle.js","mappings":";;;;;;;;;AAAA;AACA;AACA;AACA,2BAA2B,GAAG;AAC9B;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA,2BAA2B,GAAG;AAC9B;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;;;;;;;;;;AClDA,gBAAgB,mBAAO,EAAE,0CAAY;;AAErC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,SAAS;AACT;AACA;;AAEA;;;;;;;;;;AC3CA,gBAAgB,mBAAO,CAAC,0CAAY;;AAEpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB;;AAErB;AACA;AACA;AACA,iBAAiB;AACjB,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,sCAAsC,aAAa;AACnD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;;AAEzD;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;;;;;;;;;;AC5FA,gBAAgB,mBAAO,CAAC,0CAAY;;AAEpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA;AACA,qBAAqB;;AAErB;;;AAGA;AACA;AACA,kBAAkB;AAClB,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;;AAEzD;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;;;;;;;;;;ACrGA,gBAAgB,mBAAO,CAAC,0CAAY;AACpC,qBAAqB,mBAAO,CAAC,oDAAiB;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;AACA,aAAa;;AAEb;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB,UAAU;AACV;AACA;;AAEA;;;;;;UCnDA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;ACtBA,qBAAqB,mBAAO,EAAE,oDAAiB;AAC/C,uBAAuB,mBAAO,CAAC,wDAAmB;AAClD,qBAAqB,mBAAO,CAAC,oDAAiB;AAC9C,oBAAoB,mBAAO,EAAE,kDAAgB;;AAE7C;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,CAAC,C","sources":["./frontend/api_util.js","./frontend/follow_toggle.js","./frontend/infinite_tweets.js","./frontend/tweet_compose.js","./frontend/users_search.js","webpack/bootstrap","./frontend/twitter.js"],"sourcesContent":["const APIUtil = {\n    followUser: id => {\n        return $.ajax({\n            url: `/users/${id}/follow`,\n            type: 'POST',\n            dataType: 'json'\n        });\n    },\n\n    unfollowUser: id => {\n        return $.ajax({\n            url: `/users/${id}/follow`,\n            type: 'DELETE',\n            dataType: 'json'\n        });\n    },\n\n    searchUsers: queryStr => {\n        return $.ajax({\n            url: `/users/search`,\n            type: 'GET',\n            dataType: 'json',\n            data: {\n                query: queryStr\n            }\n        });\n    },\n\n    composeTweet: (json) => {\n        return $.ajax({\n            url: `/tweets`,\n            type: 'POST',\n            dataType: 'json',\n            data: json\n        });\n    },\n\n    fetchTweets: createdAtFilter => {\n        return $.ajax({\n            url: `/feed`,\n            type: 'GET',\n            dataType: 'json',\n            data: {\n                max_created_at: createdAtFilter\n            }\n        });\n    }\n\n};\n\nmodule.exports = APIUtil;","const APIUtil = require( './api_util' );\n\nclass FollowToggle {\n    constructor(el, options) {\n        this.$el = $( el );\n        this.userId = this.$el.data( 'user-id' ) || options.userId;\n        this.followState = this.$el.data( 'initial-follow-state' ) || options.followState;\n\n        this.render();\n        this.handleClick();\n    }\n\n    render () {\n        const text = ( this.followState === 'followed') ? 'Unfollow!' : 'Follow!';\n        this.$el.text( text );\n        this.$el.prop( \"disabled\", false );\n    }\n\n    handleClick () {\n        this.$el.on( 'click', event => {\n            event.preventDefault();\n\n            this.$el.prop( \"disabled\", true );\n\n            if( this.followState === 'followed' ) {\n                APIUtil.unfollowUser\n                    .call( this, this.userId )\n                    .then( () => {\n                        this.followState = 'unfollowed';\n                        this.render();\n                } );\n            } else {\n                APIUtil.followUser\n                    .call( this, this.userId )\n                    .then( () => {\n                        this.followState = 'followed' \n                        this.render();\n                } );\n            }\n        })\n    }\n}\n\nmodule.exports = FollowToggle;","const APIUtil = require(\"./api_util\");\n\nclass InfiniteTweets {\n    constructor() {\n        this.$feedContainer = $( '.infinite-tweets' ).first();\n        this.$feedList = $('#feed');\n        this.$fetchMoreBtn = $( '.fetch-more' ).first();\n        this.minCreatedAt;\n\n        this.handleFetchMore();\n        this.handleInsertTweet();\n        this.$fetchMoreBtn.trigger( 'click' );\n    }\n\n    handleFetchMore() {\n        this.$fetchMoreBtn.on( 'click', event => {\n            event.preventDefault();\n            const LIMIT = 20;\n\n            this.$fetchMoreBtn.prop( 'disabled', true);\n\n            APIUtil.fetchTweets(this.minCreatedAt)\n                .then( tweets => {\n                    this.$fetchMoreBtn.prop( 'disabled', false );\n\n                    tweets.forEach( (tweet, idx) => {\n                        \n                        const $tweet = this.createTweetElem( tweet );\n                        this.$feedList.append( $tweet );\n\n                        if( idx === tweets.length - 1) {\n                            this.minCreatedAt = tweet.created_at;\n                        }\n\n                    })\n\n                    if( tweets.length < LIMIT ) {\n                        this.$fetchMoreBtn.remove();\n                    }\n                })\n        })\n    }\n\n    handleInsertTweet() {\n        this.$feedContainer.on( 'insert-tweet', (event, data) => {\n            const $tweet = this.createTweetElem(data);\n\n            this.$feedList.prepend( $tweet );\n        })\n    }\n\n    createTweetElem(data) {\n        const $tweet = $('<li></li>');\n\n        const $content = $( '<p class=\"content\"></p>' );\n        $content.html( data.content );\n\n        const $mentions = this.createMentionsElem( data.mentions );\n\n        const $user = $( '<a class=\"created-by\"></a>');\n        $user.attr( 'href', `/users/${data.user.id}`);\n        $user.html( data.user.username );\n\n        const $createdTime = $( '<time></time>' );\n        $createdTime.html( data.created_at );\n        $createdTime.attr( 'datetime', data.created_at );\n\n        $tweet.append( $content );\n        $tweet.append( $mentions );\n        $tweet.append( $user );\n        $tweet.append( $createdTime );\n\n        return $tweet;\n    }\n\n    createMentionsElem(mentionsJSON) {\n        const $mentions = $( '<ul class=\"mentions\"></ul>' );\n\n        mentionsJSON.forEach( mention => {\n            const $mention = $( '<li></li>' );\n            const $link = $( '<a></a>');\n            $link.html( mention.user.username );\n            $link.attr( 'href', `users/${mention.user.id}` );\n\n            $mention.append( $link );\n            $mentions.append( $mention );\n        })\n\n        return $mentions;\n    }\n}\n\nmodule.exports = InfiniteTweets;","const APIUtil = require(\"./api_util\");\n\nclass TweetCompose {\n    constructor() {\n        this.$form = $( '.tweet-compose' ).first();\n        this.$allMentions = $( '.all-mentions' ).first();\n\n        this.handleSubmit();\n        this.handleCharLimit();\n        this.handleAddMention();\n        this.handleRemoveMention();\n    }\n\n    handleSubmit() {\n        const $form = this.$form;\n\n        $form.on( 'submit', event => {\n            const $inputs = $form.find( ':input' );\n            const jsonData = $form.serializeJSON();\n            event.preventDefault();\n\n            $inputs.each(function () {\n                $( this ).prop( 'disabled', true );\n            });\n\n            APIUtil.composeTweet( jsonData )\n                .then( (data) => {\n                    $inputs.each(function () {\n                        $( this ).prop( 'disabled', false );\n                    });\n\n                    const $fields = $inputs.filter( 'select, textarea' );\n                    $fields.each(function () {\n                        $( this ).val('');\n                    });\n\n                    this.$allMentions.empty();\n\n\n                    const $feed = $('#feed');\n                    const $tweetElem = $feed.trigger( 'insert-tweet', [data] );\n                } )\n        });\n    }\n\n    handleCharLimit() {\n        const $messageInput = this.$form.find('textarea').first();\n        const $charCounter = this.$form.find( '.chars-left' ).first();\n        const CHAR_LIMIT = 140;\n        \n        $messageInput.on( 'input', function() {\n            const tweetStr = $messageInput.val();\n            const charsRemaining = CHAR_LIMIT - Math.min(CHAR_LIMIT, tweetStr.length);\n            const charsRemainingStr = `${charsRemaining} chars remain`;\n\n            $charCounter.html( charsRemainingStr );\n\n            if ( charsRemaining === 0 ) {\n                $messageInput.val( tweetStr.slice(0, CHAR_LIMIT) );\n            }\n        })\n    }\n\n    handleAddMention() {\n        const $addMentionBtn = $( '.add-mention' ).first();\n\n        $addMentionBtn.on( 'click', () => {\n            const $mentionSelect = this.newUserSelect();\n            this.$allMentions.append( $mentionSelect );\n        })\n    }\n\n    handleRemoveMention() {\n        this.$form.on( 'click', 'a.remove-mentioned-user', function(event) {\n            event.preventDefault();\n            $(this).parent().remove();\n        })\n    }\n\n    newUserSelect() {\n        const $mentionContainer = $( '<div class=\"mention-container\"></div>');\n        const $mentionSelect = $( '<select name=\"tweet[mentioned_user_ids][]\"></select>' );\n        const $placeholderOption = $( '<option selected disabled>Select a User...</option>');\n        const $mentionDelete = $( '<a href=\"#\" class=\"remove-mentioned-user\">🗑️</a>' );\n\n        $mentionContainer.append( $mentionSelect );\n        $mentionSelect.append( $placeholderOption );\n        $mentionContainer.append( $mentionDelete );\n\n        window.users.forEach( user => {\n            const $option = $( '<option></option>' );\n            $option.val( user.id );\n            $option.html( user.username );\n\n            $mentionSelect.append( $option );\n        })\n\n        return $mentionContainer;\n    }\n}\n\nmodule.exports = TweetCompose;","const APIUtil = require('./api_util');\nconst FollowToggle = require('./follow_toggle');\n\nclass UsersSearch {\n    constructor(el) {\n        this.$el = $( el );\n        this.$input = this.$el.find( 'input' );\n        this.$ul = this.$el.find('ul.users');\n\n        this.handleInput();\n    }\n\n    render(users) {\n        this.$ul.empty();\n\n        users.forEach( user => {\n            const $listItem = $( '<li></li>');\n            const $listLink = $( '<a></a>' );\n            const linkURL = `/users/${user.id}`;\n            const followBtn = new FollowToggle('<button></button>', {\n                userId: user.id,\n                followState: ( user.followed ) ? 'followed' : 'unfollowed'\n            })\n\n            followBtn.$el.addClass( 'follow-toggle' );\n\n            $listLink.attr(\"href\", linkURL);\n            $listLink.text( user.username );\n\n            $listItem.append( $listLink );\n\n            $listItem.append( followBtn.$el );\n\n            this.$ul.append( $listItem );\n        });\n    }\n\n    handleInput() {\n        const search = this;\n\n        search.$input.on( 'input', function() {\n            const searchStr = search.$input.val();\n\n            APIUtil.searchUsers( searchStr )\n                .then( users => {\n                    search.render( users );\n                })\n        } );\n    }\n}\n\nmodule.exports = UsersSearch;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const FollowToggle = require( './follow_toggle');\nconst InfiniteTweets = require('./infinite_tweets');\nconst TweetCompose = require('./tweet_compose');\nconst UsersSearch = require( './users_search');\n\n$( () => {\n    const $followBtns = $( 'button.follow-toggle' );\n    $followBtns.each( function() {\n        new FollowToggle( this );\n    })\n\n    const $userSearches = $( 'nav.users-search' );\n    $userSearches.each(function () {\n        new UsersSearch(this);\n    })\n\n    new TweetCompose();\n    new InfiniteTweets();\n})"],"names":[],"sourceRoot":""}